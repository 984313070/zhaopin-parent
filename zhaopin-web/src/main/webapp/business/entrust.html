
<!-- public:header 以下内容 -->
<!doctype html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
    <title>网站后台管理中心- Powered by 74cms.com</title>
    <link rel="shortcut icon" href="../upload/favicon.ico"/>
    <script src="../upload/Application/Admin/View/default/public/vue/axios.min.js"></script>
    <script src="../upload/Application/Admin/View/default/public/vue/vue.min.js"></script>
    <meta name="author" content="骑士CMS" />
    <meta name="copyright" content="74cms.com" />
    <link href="../upload/Application/Admin/View/default/public/css/common.css" rel="stylesheet" type="text/css">
    <script src="../upload/Application/Admin/View/default/jquery-1.9.1.min.js"></script>

    <![endif]-->
    <script>
        var URL = '../upload/index.php/admin/personal',
            SELF = '../upload/index.php?m=admin&amp;c=personal&amp;a=entrust',
            ROOT_PATH = '../upload/index.php/admin',
            APP	 =	 '../upload/index.php';

        var qscms = {
            is_subsite : 0,
            subsite_level : "3",
            default_district : ""
        };
    </script>
    <script src="../upload/Application/Admin/View/default/jquery-1.9.1.min.js"></script>
    <style type="text/css">
        .popWindow{
            background-color:#ffffff;
            border-radius:3px;
            border:2px solid #075E8B;
            position:absolute;
            display:block;
            width:460px;
            height:300px;
            left:30%;
            top:30%;
            box-shadow:5px 5px 5px #322E2F;
            z-index:999;
        }
    </style>
</head>

<body>
<!-- public:header 以上内容 -->
<div class="allpagetop">个人<strong>/</strong>委托投递</div><div class="mains">
    <div class="h1tit">
        <div class="h1">
            委托投递                        </div>
        <div class="clear"></div>
    </div>
    <div class="toptip">
        <div class="toptit">提示：</div>
        <p>求职者委托简历后，求职顾问可根据其意向职位筛选并投递合适的职位。</p>
    </div>
    <!-- <div class="seltpye_y">
        <div class="tit">委托时长</div>
        <div class="ct">
            <div class="txt ">不限</div>
        </div>
        <div class="downlist">
            <li url="../upload/index.php?m=admin&c=personal&a=entrust&entrust=&entrust_cn=%E4%B8%8D%E9%99%90">不限</li>
            <li url="../upload/index.php?m=admin&c=personal&a=entrust&entrust=3&entrust_cn=%E4%B8%89%E5%A4%A9%E5%86%85">三天</li>
            <li url="../upload/index.php?m=admin&c=personal&a=entrust&entrust=7&entrust_cn=%E4%B8%80%E5%91%A8%E5%86%85">一周</li>
            <li url="../upload/index.php?m=admin&c=personal&a=entrust&entrust=14&entrust_cn=%E4%B8%A4%E5%91%A8%E5%86%85">两周</li>
            <li url="../upload/index.php?m=admin&c=personal&a=entrust&entrust=30&entrust_cn=%E4%B8%80%E6%9C%88%E5%86%85">一月</li>
        </div>
    </div> -->
    <!--<div class="seltpye_y">
        <div class="tit">简历照片</div>
        <div class="ct">
            <div class="txt ">不限</div>
        </div>
        <div class="downlist">
            <li url="../upload/index.php?m=admin&c=personal&a=entrust&photos=&photos_cn=%E4%B8%8D%E9%99%90">不限</li>
            <li url="../upload/index.php?m=admin&c=personal&a=entrust&photos=1&photos_cn=%E6%9C%89">有</li>
            <li url="../upload/index.php?m=admin&c=personal&a=entrust&photos=2&photos_cn=%E6%97%A0">无</li>
        </div>
    </div>-->
    <div class="seltpye_y">
        <div class="tit">创建时间</div>
        <div class="ct">
            <div class="txt ">不限</div>
        </div>
        <div class="downlist">
            <li url="javascript:search(0)">不限</li>
            <li url="javascript:search(0)">三天内</li>
            <li url="javascript:search(0)">一周内</li>
            <li url="javascript:search(0)">一月内</li>
        </div>
    </div>
    <div class="seltpye_y">
        <div class="tit">刷新时间</div>
        <div class="ct">
            <div class="txt ">不限</div>
        </div>
        <div class="downlist">
            <li url="../upload/index.php?m=admin&c=personal&a=entrust&settr=&settr_cn=%E4%B8%8D%E9%99%90">不限</li>
            <li url="../upload/index.php?m=admin&c=personal&a=entrust&settr=3&settr_cn=%E4%B8%89%E5%A4%A9%E5%86%85">三天内</li>
            <li url="../upload/index.php?m=admin&c=personal&a=entrust&settr=7&settr_cn=%E4%B8%80%E5%91%A8%E5%86%85">一周内</li>
            <li url="../upload/index.php?m=admin&c=personal&a=entrust&settr=30&settr_cn=%E4%B8%80%E6%9C%88%E5%86%85">一月内</li>
        </div>
    </div>
    <div class="seltpye_y">
        <div class="tit">排序方式</div>
        <div class="ct">
            <div class="txt ">发布时间</div>
        </div>
        <div class="downlist">
            <li url="#">创建时间</li>
            <li url="#">刷新时间</li>
        </div>
    </div>
    <div class="clear"></div>

    <div id="entrust_grid">
        <form id="form1" name="form1" method="post" >
            <div class="list_th">
                <div class="td" style=" width:10%;">
                    <label id="chkAll" class="left_padding">
                        <input type="checkbox" @click="checkAll" v-model="checked">
                        <span>全选/姓名</span>
                    </label>
                </div>
                <div class="td" style=" width:18%;">基本信息</div>
                <div class="td" style=" width:8%;">简历完整度</div>
                <div class="td center" style=" width:6%;">投递次数&nbsp;&nbsp;&nbsp;</div>
                <div class="td center" style=" width:17%;">委托期限</div>
                <div class="td center" style=" width:8%;">创建时间</div>
                <div class="td center" style=" width:10%;">刷新时间</div>
                <div class="td" style=" width:20%;">操作</div>
                <div class="clear"></div>
            </div>
            <div class="list_tr link_black" v-for=" ent in entrystList ">
                <input type="text" name="id" style="display: none">
                <div class="td" style=" width:10%;">
                    <div class="left_padding striking">
                        <input type="checkbox" v-model="checkModel" :value="ent.id">{{ent.id}}
                        {{ ent.fullname }}
                        <a href="#" target="_blank"></a>
                        &nbsp;
                        <span class="vtip" title="<img src='#' border=0 align=absmiddle width=120 height=120>">
                                <img class="avatar small" src="{{ent.photoImg}}" align="absmiddle">
                        </span>
                    </div>
                </div>


                <div class="td" style=" width:18%;">
                    {{ ent.birthdate }}岁 / {{ ent.sexCn }} / {{ ent.educationCn }} / {{ ent.experienceCn }}
                </div>
                <div class="td" style=" width:8%;">
                    <div style="width:100px; background-color:#CCCCCC; position:relative; margin-top: 20px;" title="完整度:0%">
                        <div style="background-color: #99CC00; height:16px; width:0%;"></div>
                        <div style="position:absolute; top:0; left: 40%; font-size:10px; width: 100px; height: 16px; line-height: 16px;">
                            {{ent.completePercent}}%
                        </div>
                    </div>
                </div>

                <div class="td center" style=" width:6%;">
                    0
                </div>
                <div class="td center" style=" width:17%;">
                    {{new Date(ent.wordResumeAddtime*1000).toLocaleString()}}至{{new Date(ent.stime*1000).toLocaleString()}}
                </div>
                <div class="td center" style=" width:8%;">
                    {{new Date(ent.addtime*1000).toLocaleString()}}
                </div>
                <div class="td center" style=" width:10%;">
                    {{new Date(ent.refreshtime*1000).toLocaleString()}}
                </div>
                <div class="td edit" style=" width:20%;">
                    <a href="javascript:void(0)" @click="javascript:match(ent.id)">匹配</a>
                    <a href="javascript:void(0)" @click="deleteResumeById(ent.id)" class="gray">删除</a>
                    <!--<a href="javascript:void(0)" @click="exportResumeList()" value="导出"/>-->
                </div>
                <div class="clear"></div>
            </div>
        </form>
        <div class="list_foot">
            <div class="btnbox">
                <input type="button" class="admin_submit" onclick="window.location.reload();" id="ButRefresh" value="刷新"/>
                <input type="button" class="admin_submit" id="ButDel" onclick="deleteResume()" value="删除"/>
                <!--<input type="button" onclick="importXLS()" class="admin_submit"  value="导入"/>-->
                <input type="button" onclick="exportExce()" class="admin_submit"  value="导出"/>
            </div>

            <div class="footso">
                <form action="?" method="get">
                    <div class="sobox">
                        <input type="hidden" name="m" value="Admin">
                        <input type="hidden" name="c" value="Personal">
                        <input type="hidden" name="a" value="entrust">
                        <input name="key" type="text" class="sinput" value=""/>
                        <input name="key_type" id="J_key_type_id" type="hidden" value="1" />
                        <input name="key_type_cn" id="J_key_type_cn" type="hidden" value="姓名"/>
                        <input name="" type="submit" value="" class="sobtn"/>
                        <div class="sotype" id="J_key_click">姓名</div>
                        <div class="mlist" id="J_mlist">
                            <ul>
                                <li id="1" title="姓名">姓名</li>
                                <li id="2" title="简历ID">简历ID</li>
                                <li id="3" title="会员ID">会员ID</li>
                                <li id="4" title="电话">电话</li>
                                <li id="5" title="地址">地址</li>
                            </ul>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div class="pages">
            <a class='unable'>上一页</a>
            <span class='current'>1</span>
            <a class='unable'>下一页</a>
        </div>
    </div>

</div>

<div id="dialogId">
    <div class="popWindow" v-show="ok">
        <table style="width:100%;line-height:22px;" cellspacing="0" cellpadding="0">
            <tr style="background-color:#075E8B;">
                <td style="color:#e2e2e2;font-family:bolder;font-size:10pt;">删除框</td>
                <td style="color:#EBEBEB;font-weight:bolder;width:20px;">
                    <img onclick="closeDialog()"  src="../upload/Application/Admin/View/default/public/images/menu/cross.png" style="width:16px;height:16px;" title="关闭"/>
                </td>
            </tr>
        </table>
        <div>
            请选择要导入的excel文件
            <input type="file"  id="file">

        </div>
        <input type="button" onclick="importXLS1()" class="admin_submit"  value="确定"/>
        <input type="button" onclick="closeDialog()" class="admin_submit"  value="取消"/>
    </div>
</div>
<!-- public:footer 以下内容 -->
<div class="footer link_blue">
    Powered by <a href="http://www.74cms.com" target="_blank"><span style="color:#009900">74</span><span
        style="color: #FF3300">cms</span></a> v4.2.111</div>
<!-- public:footer 以上内容 -->
</body>
<script type="text/javascript">
    $(document).ready(function () {
        //投递记录
        $(".apply_log").click(function () {
            var qsDialog = $(this).dialog({
                title: '投递记录',
                loading: true,
                footer : false
            });
            var param = $(this).attr('parameter');
            var url = "../upload/index.php?m=admin&c=ajax&a=entrust_apply_log&" + param;
            $.getJSON(url, function (result) {
                qsDialog.setContent(result.data);
            });
        });
        //点击批量删除
       /* $("#ButDel").click(function () {
            if (confirm('你确定要删除吗？')) {
                $("form[name=form1]").attr("action", "../upload/index.php?m=admin&c=personal&a=resume_delete");
                $("form[name=form1]").submit();
            }
        })*/
    });
   var vm;
    $(function () {
        //alert(1)
        $.ajax({
            type: "post",
            url: "../resume/search.do",
            data: '',
            dataType: "",
            success: function (result) {
                //alert(result.rows);
                vm = new Vue({
                    el: '#entrust_grid',
                    data: {
                        entrystList: result.rows,
                        checked:false, //是否全选
                        checkModel:[] //双向数据绑定的数组，我是用的id
                    },

                    watch:{
                        checkModel(){
                            if(this.checkModel.length==this.entrystList.length){
                                this.checked=true;
                            }else{
                                this.checked=false;
                            }
                        }
                    },
                    methods:{
                        checkAll(){
                            if(this.checked){
                                this.entrystList.forEach((item)=>{
                                    if(this.checkModel.indexOf(item.id)==-1){
                                        this.checkModel.push(item.id)
                                    }
                                })

                            }else{
                                this.checkModel=[];
                            }
                        }
                    }
                })
            },
            error: function () {
                alert("系统错误，请联系管理员！");
            }
        })
    })
    /*   function search(page){
          $.post('../resume/search.do',{page:page,rows:5},function (result){
              var age = 0;
              var date = new Date()
              for (var i = 0;i < result.rows.length;i++) {
                  age = date.getFullYear() - result.rows[i].birthdate
                  result.rows[i].birthdate = age;
              }
              vm.sites = result.rows;
          })
      }*/
     function search(page, rows) {
          $.ajax({
              type: "post",
              url: "../resume/search.do?page="+page+"&rows="+rows,
              data: {},
              dataType: "",
              success: function (result) {
                  vm.entrystList = result.rows;
              },
              error: function () {
                  alert("系统错误，请联系管理员！");
              }
          })
      }

    //批量删除全部简历信息
  function deleteResume(){
        var arr = vm.checkModel;
        //alert(arr)
        var ids = "";
        for (var i = 0; i < arr.length; i++) {
            ids+=","+arr[i];
        }
        ids=ids.substring(1);
        //alert(ids)
        if(ids == ""){
            alert("请选择要删除的数据");
            return "";
        }
        if(confirm("确定要删除吗？")){
            $.post('../resume/delResume.do',{ids:ids},function (data){
                if(data.success){
                    alert(data.message);
                    window.location.reload();
                }else{
                    alert(data.message);
                }
            })
        }
    }
    //删除全部简历信息
    function deleteResumeById(id){
        if(confirm("确定要删除吗？")){
            $.post('../resume/deleteResumeById.do',{id:id},function (data){
                if(data.success){
                    alert(data.message);
                    window.location.reload();
                }else{
                    alert(data.message);
                }
            })
        }
    }

    function match(id){
        window.location.href="match.html?id="+id;
    }

    //导出
    /*function exportResumeList(){
        window.location.href = "../resume/exportResumeList.do";
    }*/

    //导入
    var dialog = new Vue({
        el: '#dialogId',
        data: {
            ok: false,
            excel:'',
        }
    })

    function exportExce(){
        window.location.href = "../resume/exportResumeList.do";
    }
    function importXLS1(){
        var file_url = document.getElementById("file").value;
        $.post('../resume/importXLS.do',{filePath:file_url},function (data) {
            alert(data.message);
            closeDialog();
            window.location.reload();
        })
    }
    function importXLS () {
        openDialog();
    }

    function closeDialog() {
        dialog.ok=false;
    }
    function openDialog(){
        dialog.ok=true;
    }
</script>
</html>